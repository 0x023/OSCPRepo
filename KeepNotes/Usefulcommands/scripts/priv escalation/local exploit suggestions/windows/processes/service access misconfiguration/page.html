<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Service Access Misconfiguration</title>
</head><body>Check access rights. Grab <a href="http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx">accesschk.exe</a>&nbsp;from Sysinternals. Accesschk can automatically check if we have write access to a Windows service with a certain user level. Generally as a low privilege user we will want to check for "Authenticated Users". Make sure to check which user groups you user belongs to, "Power Users" for example is considered a low privilege user group (though it is not widely used). Looking for Write access to a service in order to reconfigure it to gain elevated access. <br/>
# We can use sc to query, configure and manage windows services.<br/>
C:\Windows\system32&gt; sc qc Spooler<br/>
<br/>
# We can see the permissions that each user level has, you can also use "accesschk.exe -ucqv *" to list<br/>
all services.<br/>
C:\&gt; accesschk.exe -ucqv Spooler<br/>
<br/>
EXAMPLE:<br/>
<span style="font-family: inherit">C:\&gt; accesschk.exe -ucqv upnphost<br/>
<br/>
upnphost<br/>
<br/>
&nbsp; RW NT AUTHORITY\SYSTEM<br/>
&nbsp; &nbsp; &nbsp; &nbsp; SERVICE_ALL_ACCESS<br/>
&nbsp; RW BUILTIN\Administrators<br/>
&nbsp; &nbsp; &nbsp; &nbsp; SERVICE_ALL_ACCESS<br/>
<b>&nbsp; RW NT AUTHORITY\Authenticated Users<br/>
</b><b>&nbsp; &nbsp; &nbsp; &nbsp; SERVICE_ALL_ACCESS</b><br/>
&nbsp; RW BUILTIN\Power Users<br/>
&nbsp; &nbsp; &nbsp; &nbsp; SERVICE_ALL_ACCESS<br/>
&nbsp; RW NT AUTHORITY\LOCAL SERVICE<br/>
</span><span style="font-family: inherit">&nbsp; &nbsp; &nbsp; &nbsp; SERVICE_ALL_ACCESS</span><br/>
<br/>
<img src="image 2.png" /><br/>
<br/>
<br/>
The important thing to remember is that we find out what user groups our compromised session belongs to. As mentioned previously "Power Users" is also considered to be a low privileged user group. "Power Users" have their own set of vulnerabilities, Mark Russinovich has written a very interesting <a href="http://blogs.technet.com/b/markrussinovich/archive/2006/05/01/the-power-in-power-users.aspx">article</a>&nbsp;on the subject.<br/>
</body></html>