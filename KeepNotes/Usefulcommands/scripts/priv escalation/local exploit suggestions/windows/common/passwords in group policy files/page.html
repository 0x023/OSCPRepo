<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Passwords in Group Policy Files</title>
</head><body>Scripts available<br/>
<br/>
Search for Group Policy Preference saved passwords<br/>
Obscured with encryption. Key is/was published on the msdn website:<br/>
<img src="image.png" />&nbsp; <br/>
Groups.xml &#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Stored in <a href="https://technet.microsoft.com/en-us/library/cc816833(v=ws.10).aspx">SYSVOL</a>&nbsp; <br/>
<br/>
Metasploit module post/windows/gather/credentials/gpp<br/>
(retrieve 'cpassword' values and decrypt with the known AES key)<br/>
<br/>
PowerSploit module PowerSploit/Exfiltration/<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">Get-GPPPassword.ps1</a>&nbsp;<br/>
<br/>
Other places to look for passwords<br/>
<br/>
Services\Services.xml: &#09;&#09;&#09;&#09;&#09;&#09;<a href="http://msdn.microsoft.com/en-us/library/cc980070.aspx">Element-Specific Attributes</a><br/>
ScheduledTasks\ScheduledTasks.xml: &#09;&#09;&#09;<a href="http://msdn.microsoft.com/en-us/library/cc422920.aspx">Task Inner Element</a>, <a href="">TaskV2 Inner Element</a>, <a href="http://msdn.microsoft.com/en-us/library/dd304114.aspx">ImmediateTaskV2 Inner Element</a><br/>
Printers\Printers.xml: &#09;&#09;&#09;&#09;&#09;&#09;<a href="http://msdn.microsoft.com/en-us/library/cc422918.aspx">SharedPrinter Element</a><br/>
Drives\Drives.xml: &#09;&#09;&#09;&#09;&#09;&#09;&#09;<a href="http://msdn.microsoft.com/en-us/library/cc704598.aspx">Element-Specific Attributes</a><br/>
DataSources\DataSources.xml: &#09;&#09;&#09;&#09;&#09;<a href="http://msdn.microsoft.com/en-us/library/cc422926.aspx">Element-Specific Attributes</a></body></html>