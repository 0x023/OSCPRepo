<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SMB / rpcclient</title>
</head><body>$ rpcclient â€”U &lt;username&gt; &lt;WinIPaddr&gt;&#09;&#09;&#09;Linux: connect to share<br/>
<br/>
rpcclient $&gt; srvinfo&#09;&#09;&#09;&#09;&#09;&#09;&#09;Get hostname information. Refer to <a href="http://en.wikipedia.org/wiki/Comparison_of_Microsoft_Windows_versions">here</a>.<br/>
rpcclient $&gt; enumdomusers&#09;&#09;&#09;&#09;&#09;Get usernames and RIDs<br/>
rpcclient $&gt; enumalsgroups domain&#09;&#09;&#09;&#09;Enumerate domain groups<br/>
rpcclient $&gt; enumalsgroups builtin&#09;&#09;&#09;&#09;Enumerate builtin groups<br/>
rpcclient $&gt; queryuser 500&#09;&#09;&#09;&#09;&#09;&#09;Query detailed user information based on RID<br/>
Note here that the output shows the last logon time for the user, as well as the Password last set Time. That kind of stuff is immensely valuable for auditors and penetration testers alike.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
Other commands<br/>
enumalsgroups &nbsp;enumdomains &nbsp; &nbsp;enumdrivers &nbsp; &nbsp;enumkey &nbsp; &nbsp; enumprivs<br/>
enumdata &nbsp; &nbsp; &nbsp; enumdomgroups &nbsp;enumforms &nbsp; &nbsp; &nbsp;enumports &nbsp; enumtrust<br/>
enumdataex &nbsp; &nbsp; enumdomusers &nbsp; enumjobs &nbsp; &nbsp; &nbsp; enumprinter</body></html>