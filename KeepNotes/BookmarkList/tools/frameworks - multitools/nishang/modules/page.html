<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Modules</title>
</head><body>Scripts<br/>
Nishang currently contains the following scripts and payloads.<br/>
<br/>
<b>ActiveDirectory</b><br/>
Set-DCShadowPermissions&#09;Modify AD objects to provide minimal permissions required for DCShadow.<br/>
<br/>
<b>Antak - the Webshell</b><br/>
Antak &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;&#09;&#09;Execute PowerShell scripts in memory, run commands, and download and upload files using this webshell.<br/>
<br/>
<b>Backdoors</b><br/>
HTTP-Backdoor&#09;&#09;&#09;&#09;A backdoor which can receive instructions from third party websites and execute PowerShell scripts in memory.<br/>
DNS_TXT_Pwnage&#09;&#09;&#09;A backdoor which can receive commands and PowerShell scripts from DNS TXT queries, execute them on a target, and be remotely controlled using the queries.<br/>
<br/>
Execute-OnTime&#09;&#09;&#09;A backdoor which can execute PowerShell scripts at a given time on a target.<br/>
Gupt-Backdoor&#09;&#09;&#09;&#09;A backdoor which can receive commands and scripts from a WLAN SSID without connecting to it.<br/>
Add-ScrnSaveBackdoor&#09;&#09;A backdoor which can use Windows screen saver for remote command and script execution.<br/>
Invoke-ADSBackdoor&#09;&#09;&#09;A backdoor which can use alternate data streams and Windows Registry to achieve persistence.<br/>
Add-RegBackdoor&#09;&#09;&#09;A backdoor which uses well known Debugger trick to execute payload with Sticky keys and Utilman (Windows key + U).<br/>
Set-RemoteWMI&#09;&#09;&#09;Modify permissions of DCOM and WMI namespaces to allow access to a non-admin user.<br/>
Set-RemotePSRemoting&#09;&#09;Modify permissions of PowerShell remoting to allow access to a non-admin user.<br/>
<br/>
<b>Bypass</b><br/>
Invoke-AmsiBypass&#09;&#09;&#09;Implementation of publicly known methods to bypass/avoid AMSI.<br/>
<br/>
<b>Client</b><br/>
Out-CHM&#09;&#09;&#09;&#09;&#09;Create infected CHM files which can execute PowerShell commands and scripts.<br/>
Out-Word&#09;&#09;&#09;&#09;&#09;Create Word files and infect existing ones to run PowerShell commands and scripts.<br/>
Out-Excel&#09;&#09;&#09;&#09;&#09;Create Excel files and infect existing ones to run PowerShell commands and scripts.<br/>
Out-HTA&#09;&#09;&#09;&#09;&#09;Create a HTA file which can be deployed on a web server and used in phishing campaigns.<br/>
Out-Java&#09;&#09;&#09;&#09;&#09;Create signed JAR files which can be used with applets for script and command execution.<br/>
Out-Shortcut&#09;&#09;&#09;&#09;Create shortcut files capable of executing PowerShell commands and scripts.<br/>
Out-WebQuery&#09;&#09;&#09;&#09;Create IQY files for phishing credentials and SMB hashes.<br/>
Out-JS&#09;&#09;&#09;&#09;&#09;Create JS files capable of executing PowerShell commands and scripts.<br/>
Out-SCT&#09;&#09;&#09;&#09;&#09;Create SCT files capable of executing PowerShell commands and scripts.<br/>
Out-SCF&#09;&#09;&#09;&#09;&#09;Create a SCF file which can be used for capturing NTLM hash challenges.<br/>
<br/>
<b>Escalation</b><br/>
Enable-DuplicateToken&#09;&#09;When SYSTEM privileges are required.<br/>
Remove-Update&#09;&#09;&#09;&#09;Introduce vulnerabilities by removing patches.<br/>
Invoke-PsUACme&#09;&#09;&#09;Bypass UAC.<br/>
<br/>
<b>Execution</b><br/>
Download-Execute-PS&#09;&#09;Download and execute a PowerShell script in memory.<br/>
Download_Execute&#09;&#09;&#09;Download an executable in text format, convert it to an executable, and execute.<br/>
Execute-Command-MSSQL&#09;Run PowerShell commands, native commands, or SQL commands on a MSSQL Server with sufficient privileges.<br/>
Execute-DNSTXT-Code&#09;&#09;Execute shellcode in memory using DNS TXT queries.<br/>
Out-RundllCommand&#09;&#09;&#09;Execute PowerShell commands and scripts or a reverse PowerShell session using rundll32.exe.<br/>
<br/>
<b>Gather</b><br/>
Check-VM&#09;&#09;&#09;&#09;Check for a virtual machine.<br/>
Copy-VSS&#09;&#09;&#09;&#09;Copy the SAM file using Volume Shadow Copy Service.<br/>
Invoke-CredentialsPhish&#09;&#09;Trick a user into giving credentials in plain text.<br/>
FireBuster FireListener&#09;&#09;A pair of scripts for egress testing<br/>
Get-Information&#09;&#09;&#09;&#09;Get juicy information from a target.<br/>
Get-LSASecret&#09;&#09;&#09;&#09;Get LSA Secret from a target.<br/>
Get-PassHashes&#09;&#09;&#09;Get password hashes from a target.<br/>
Get-WLAN-Keys&#09;&#09;&#09;Get WLAN keys in plain text from a target.<br/>
Keylogger&#09;&#09;&#09;&#09;&#09;Log keystrokes from a target.<br/>
Invoke-MimikatzWdigestDowngrade&#09;Dump user passwords in plain on Windows 8.1 and Server 2012<br/>
Get-PassHints&#09;&#09;&#09;&#09;Get password hints of Windows users from a target.<br/>
Show-TargetScreen&#09;&#09;&#09;Connect back and Stream target screen using MJPEG.<br/>
Invoke-Mimikatz&#09;&#09;&#09;Load mimikatz in memory. Updated and with some customisation.<br/>
Invoke-Mimikittenz&#09;&#09;&#09;Extract juicy information from target process (like browsers) memory using regex.<br/>
Invoke-SSIDExfil&#09;&#09;&#09;Exfiltrate information like user credentials, using WLAN SSID.<br/>
Invoke-SessionGopher&#09;&#09;Identify admin jump-boxes and/or computers used to access Unix machines.<br/>
<br/>
<b>MITM</b><br/>
Invoke-Interceptor&#09;&#09;&#09;A local HTTPS proxy for MITM attacks.<br/>
<br/>
<b>Pivot</b><br/>
Create-MultipleSessions&#09;&#09;Check credentials on multiple computers and create PSSessions.<br/>
Run-EXEonRemote &#09;&#09;&#09;Copy and execute an executable on multiple machines.<br/>
Invoke-NetworkRelay &#09;&#09;&#09;Create network relays between computers.<br/>
<br/>
<b>Prasadhak</b><br/>
Prasadhak&#09;&#09;&#09;&#09;Check running hashes of running process against the VirusTotal database.<br/>
<br/>
<b>Scan<br/>
</b>Brute-Force&#09;&#09;&#09;&#09;Brute force FTP, Active Directory, MSSQL, and Sharepoint.<br/>
Port-Scan&#09;&#09;&#09;&#09;&#09;A handy port scanner.<br/>
<br/>
<b>Powerpreter</b><br/>
Powerpreter&#09;&#09;&#09;&#09;All the functionality of nishang in a single script module.<br/>
<br/>
<b>Shells</b><br/>
Invoke-PsGcat&#09;&#09;&#09;&#09;Send commands and scripts to specifed Gmail account to be executed by Invoke-PsGcatAgent<br/>
Invoke-PsGcatAgent&#09;&#09;&#09;Execute commands and scripts sent by Invoke-PsGcat.<br/>
Invoke-PowerShellTcp&#09;&#09;An interactive PowerShell reverse connect or bind shell<br/>
Invoke-PowerShellTcpOneLine&#09;Stripped down version of Invoke-PowerShellTcp. Also contains, a skeleton version which could fit in two tweets.<br/>
Invoke-PowerShellTcpOneLineBind&#09;Bind version of Invoke-PowerShellTcpOneLine.<br/>
Invoke-PowerShellUdp&#09;&#09;An interactive PowerShell reverse connect or bind shell over UDP<br/>
Invoke-PowerShellUdpOneLine&#09;Stripped down version of Invoke-PowerShellUdp.<br/>
Invoke-PoshRatHttps&#09;&#09;&#09;Reverse interactive PowerShell over HTTPS.<br/>
Invoke-PoshRatHttp&#09;&#09;&#09;Reverse interactive PowerShell over HTTP.<br/>
Remove-PoshRat&#09;&#09;&#09;Clean the system after using Invoke-PoshRatHttps<br/>
Invoke-PowerShellWmi&#09;&#09;Interactive PowerShell using WMI.<br/>
Invoke-PowerShellIcmp&#09;&#09;An interactive PowerShell reverse shell over ICMP.<br/>
Invoke-JSRatRundll&#09;&#09;&#09;An interactive PowerShell reverse shell over HTTP using rundll32.exe.<br/>
Invoke-JSRatRegsvr&#09;&#09;&#09;An interactive PowerShell reverse shell over HTTP using regsvr32.exe.<br/>
<br/>
<b>Utility</b><br/>
Add-Exfiltration&#09;&#09;&#09;&#09;Add data exfiltration capability to Gmail, Pastebin, a web server, and DNS to any script.<br/>
Add-Persistence&#09;&#09;&#09;Add reboot persistence capability to a script.<br/>
Remove-Persistence&#09;&#09;&#09;Remote persistence added by the Add-Persistence script.<br/>
Do-Exfiltration&#09;&#09;&#09;&#09;Pipe (|) this to any script to exfiltrate the output.<br/>
Download&#09;&#09;&#09;&#09;&#09;Transfer a file to the target.<br/>
Parse_Keys&#09;&#09;&#09;&#09;Parse keys logged by the keylogger.<br/>
Invoke-Encode&#09;&#09;&#09;&#09;Encode and compress a script or string.<br/>
Invoke-Decode&#09;&#09;&#09;&#09;Decode and decompress a script or string from Invoke-Encode.<br/>
Start-CaptureServer&#09;&#09;&#09;Run a web server which logs Basic authentication and SMB hashes.<br/>
ConvertTo-ROT13&#09;&#09;&#09;Encode a string to ROT13 or decode a ROT13 string.<br/>
Out-DnsTxt&#09;&#09;&#09;&#09;Generate DNS TXT records which could be used with other scripts.<br/>
<br/>
[Base64ToString]<br/>
[StringToBase64]<br/>
[ExetoText]<br/>
[TexttoExe]</body></html>