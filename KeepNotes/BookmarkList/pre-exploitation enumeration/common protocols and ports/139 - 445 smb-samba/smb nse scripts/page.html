<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SMB NSE Scripts</title>
</head><body>#Running<br/>
#smb-enum-domains: attempt to enum domains on a system with policies. generally requires creds.<br/>
#smb-enum-groups: obtain a list of grous from remote system as well as a list of groups users. Works similar to 'enum.exe /g'<br/>
#smb-enum-processes: pull list of processes from remote server over SMB. Done by query remote registry service. disabled by default on Vista. Requires Admin on others.<br/>
#smb-enum-sessions: enumerate users logged in locally or through share. reading remote registry (Vista disabled by default). Requires higher than 'anonymous'<br/>
#smb-enum-shares: attempt to list shares using srvsvc.NetShareEnumAll MSRPC and NetShareGetInfo. NetShareGetInfo requires Admin<br/>
#mb-enum-users: attempt to enum users on remote system through MSRPC over 445 or 139. SAMR enum and LSA brute.<br/>
#smb-os-discovery: attempt to determine OS, computer name, domain, workgroup, and current time over SMB. anonymous.<br/>
#smb-protocols: attempts to initiate a connection using each version of SMB. if SMBv1 is found, it will mark it as insecure.<br/>
#smb-system-info: pulls info from registry. Requires Admin, though auth user should get some info.<br/>
#smb-vuln-cve-2017-7494: check if vuln to Arbitrary Shared Library Load vuln CVE-2017-7494. Unpatched Samba from 3.5.0-4.4.13 and prior to 4.5.10 and 4.6.4 are affected by RCE.<br/>
#smb-vuln-ms17-010: check if vuln to MS17-010 aka EternalBlue. Connects to $IPC tree, executes transaction and checks if error. SMBv1 vuln.<br/>
#smb-double-pulsar-backdoor: check if target is running Double Pulsar SMB backdoor<br/>
#smb2-vuln-uptime: attempt to detect missing patches in windows sytems by checking the uptime returned during the SMB2 protocol negotiation<br/>
#smb-ls: attempts to retrieve useful information about files shared on SMB volumes. Resemble output of 'ls' command<br/>
#smb-security-mode: returns information about the SMB security level determined by SMB, ie signing, challenge-response, etc<br/>
#smb2-security-mode: determines mesage signing config in SMBv2 servers for all supported dialects.<br/>
#smb-vuln-ms10-061: check if vuln to ms10-061 Printer Spooler impersonation. used in Stuxnet. Checks for vuln in safe way without crashing. Needs access to at least one shared printer.<br/>
<br/>
#Not running<br/>
#smb-enum-services: retries list of services running. Requires Admin. No longer default available.<br/>
#smb-brute: Attempt to guess login over SMB<br/>
#smb-flood: exhausts a remote SMB server's connection limit by opening as many as possible.<br/>
#smb-mbenum: queries information managed by the Windows Master Browser<br/>
#smb-print-text: attempt to print test on a shared printer by calling Printer Spooler Service RPC functions<br/>
#smb-psexec: arguably most powerful module. requires configuration. config places in /nselib/data/psexec. Read documentation. https://github.com/nmap/nmap/blob/master/scripts/smb-psexec.nse<br/>
#smb-server-stats: requires Admin. grab server stats.<br/>
#smb-vuln-conficker: Detects systems infected by conficker worm. dangerous check and may crash systems.<br/>
#smb-vuln-cve2009-3103: detects if vuln to DoS CVE-2009-3103. Will crash the service if it is vulnerable<br/>
#smb-vuln-ms06-025: check if vuln to MS06-025 RasRPCSubmitRequest RPC method<br/>
#smb-vuln-ms07-029: check if vuln to MS07-029 DNS RPC vulnerability. Will crash the service if vulnerable<br/>
#smb-vuln-ms08-067: check if vuln to MS08-067. Dangerous and may crash systems<br/>
#smb-vuln-ms10-054: check if vuln to MS10-054. Dangerous and will BSOD system<br/>
#smb-vuln-regsvc-dos: check if vuln to null pointer dereference in regsvc. Will crash service if vuln.<br/>
#smb2-capabilities: attempt to list supported cabilities in a SMBv2 server for each enabled dialect.<br/>
#smb2-time: attempt to obtain the current system date and start date of a SMB2 server</body></html>