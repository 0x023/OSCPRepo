<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Internal Range Identification</title>
</head><body>Internal range identification: <br/>
In many instances, we are provided or expected to find vulnerabilities in a 10.0.0.0/8 network which would contain around 16 million IP Addresses. Scanning 16 million IP address in a considerable time is difficult. In which case, we need faster and targeted result. So, how do we find out the ranges?<br/>
<br/>
<b>DNS Enumeration</b>: <br/>
If you are connected to a internal dns server, you may query it with<br/>
dig -t any &lt;domainname&gt;<br/>
<br/>
which should result in outputting different name servers, mail servers, A, AAAA, SOA records which would possibly give you a inner scenario how the network has been designed as there can be different nameservers, domain controllers for different locations, internal departments etc. <br/>
TODO: Convert dig output directly into hostname, ip address format.<br/>
<br/>
<b>Internal Portal Links</b>: Most of the organization have one internal portals which serves has a one-stop links to every possible portal link. This could also result in some internal range exposure. <br/>
TODO: Write the script for grep and printing host and IP address and combine it with DNS Enumeration.<br/>
<br/>
<b>Reverse DNS Lookup</b>: <br/>
Nmap provides a List scan option which does the reverse lookup. It provides the hostnames of the IP Address<br/>
nmap -sL 10.0.0.0/8<br/>
<br/>
It can also be used with the below options:<br/>
&nbsp;--randomize-hosts &nbsp;: make the scans less obvious to various network monitoring systems<br/>
&nbsp;--dns-servers server1,server2 : By default, it would use the dns servers which are listed in resolve.conf (if you haven't used --system-dns option). We can also list custom servers using these options.<br/>
</body></html>