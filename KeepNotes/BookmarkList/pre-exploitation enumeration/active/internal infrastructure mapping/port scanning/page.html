<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Port Scanning</title>
</head><body>Port Scanning:<br/>
Once you have the list of IP Addresses which are alive, we can do port scan on them. Nmap provides multiple options such as<br/>
-sS TCP SYN Stealth : Half Open SYN Scan : Nmap sends the SYN packet, Server would send SYN/ACK, System would send RST.<br/>
-sT TCP Connect Scan : Nmap uses system to send the SYN scan : Connect full TCP Handshake<br/>
-sU UDP Scan <br/>
-sA ACK Scan : Ack scan is generally used to map out firewall rulesets. Whether firewall is stateful or not.<br/>
<br/>
Please note p0f recognizes Nmap's SYN scan because of the TCP Options such as TCP window size a multiple of 1024, and only the MSS option supported with a value of 1460 (Check the tcpdump output of Ping scan above, SYN Packet). Recently, a IRC user was getting filtered port while using SYN Scan whereas was getting OPN ports which using telnet or TCP Connect Scan. Also, A patch to allow a user to override the TCP Window size in SYN scan was just posted to the <a href="https://web.archive.org/web/20170113213434/http://seclists.org/nmap-dev/2015/q3/52">Nmap Development List</a>. <br/>
<br/>
By default, nmap scans the 1000 most popular ports of each protocol ( gathered by scanning million of IP address). Scanning 1000 ports in an unknown environment with 16 million IP Address could be challenging. Nmap also provides -F Fast scan option which scans the 100 most common ports in each protocol. Otherwise it also provides --top-ports to specify an arbitrary number of ports. <br/>
<br/>
So, How do we know what are the ports scanned with --top-ports option. This could be found by<br/>
nmap -sT -oG - -v | grep '^# Ports'<br/>
or<br/>
nmap localhost -F -oX - | grep '^&lt;scaninfo'<br/>
<br/>
Nmap needs an nmap-services file with frequency information in order to know which ports are the most common. See the section called <a href="https://web.archive.org/web/20170113213434/http://seclists.org/nmap-dev/2015/q3/52">Well Known Port List: nmap-services</a>&nbsp;: for more information about port frequencies. <br/>
<br/>
We could provide ports to nmap by using -p option also, for example<br/>
-p 22 : Scan single port<br/>
-p 22,25,80 : Scan multiple ports with comma separated values. If -sS is specified TCP ports would be scanned. If -sU UDP Scan is specified, UDP Ports would be scanned.<br/>
-p80-85, 443, 8000-8005 : Scan port with ranges.<br/>
-p- : Scan all the ports excluding 0.<br/>
-pT:21,22,25,U:53,111,161 : Scan TCP 21,22,25 and UDP Ports 53,111,161. -sU must also be specified.<br/>
-p http* : wild cards may be used for ports with similar names. This would match nine ports including 80,280,443,591,593,8000,8008,8080,8443.<br/>
<br/>
Port scanning via <b>netcat</b>: Netcat might not be the best tool to use for port scanning, but can be used quickly. netcat scans TCP ports by default, but we can perform UDP scans as well. <br/>
<br/>
For a TCP scan, the format is<br/>
nc -vvn -z xxx.xxx.xxx.xxx startport-endport<br/>
<br/>
-z flag is Zero-I/O mode ( used for scannng )<br/>
-vv will provide verbose information about the results<br/>
-n flag allows to skip the DNS lookup<br/>
<br/>
For a UDP Port Scan, we need to add -u flag which makes the format<br/>
nc -vvn -u -z xxx.xxx.xxx.xxx startport-endport</body></html>