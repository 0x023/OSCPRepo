<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>MMC20</title>
</head><body>Matt Nelson <a href="https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/">documented this method</a>&nbsp;of using DCOM over RPC to instantiate a "MMC20.Application" COM object and then calling the ExecuteShellCommand method.<br/>
<br/>
Result:<br/>
Immediate command execution under the administrative account used.<br/>
<br/>
Example:<br/>
[activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.Application", "REMOTECOMPUTERNAME")).Document.ActiveView.ExecuteShellCommand("c:\windows\system32\WindowsPowerShell\v1.0\powershell.exe", $null, "parameters here", "7")';<br/>
<br/>
Implementation Details:<br/>
Connecting to remote procedure call portmapper interface (RpcSs service in svchost.exe directly listening on TCP port 135) then to an RPC server on an ephemeral port (such as 49154 or 49159 etc.).</body></html>