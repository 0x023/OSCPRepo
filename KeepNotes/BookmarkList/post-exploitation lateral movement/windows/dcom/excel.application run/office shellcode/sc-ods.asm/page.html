<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>sc-ods.asm</title>
</head><body>; Shellcode to send "Hello from sc-ods" via OutputDebugString, and sleep 5 seconds<br/>
; Written for NASM assembler (http://www.nasm.us) by Didier Stevens<br/>
; https://DidierStevens.com<br/>
; Use at your own risk<br/>
;<br/>
; History:<br/>
; &nbsp; 2008/10/14: start<br/>
; &nbsp; 2008/10/15: LookupFunctions<br/>
; &nbsp; 2008/11/24: Refactored to use include file<br/>
<br/>
BITS 32<br/>
<br/>
KERNEL32_HASH equ 0x000d4e88<br/>
KERNEL32_NUMBER_OF_FUNCTIONS equ 2<br/>
KERNEL32_OUTPUTDEBUGSTRINGA_HASH equ 0x038a721e<br/>
KERNEL32_SLEEP_HASH equ 0x00001abc<br/>
<br/>
segment .text<br/>
&#09;call geteip<br/>
geteip:<br/>
&#09;pop ebx<br/>
<br/>
&nbsp; ; Setup environment<br/>
&#09;lea esi, [KERNEL32_FUNCTIONS_TABLE-geteip+ebx]<br/>
&#09;push esi<br/>
&#09;lea esi, [KERNEL32_HASHES_TABLE-geteip+ebx]<br/>
&#09;push esi<br/>
&#09;push KERNEL32_NUMBER_OF_FUNCTIONS<br/>
&#09;push KERNEL32_HASH<br/>
&#09;call LookupFunctions<br/>
<br/>
&#09;; OutputDebugString and sleep<br/>
&#09;lea eax, [HELLO-geteip+ebx]<br/>
&#09;push eax<br/>
&#09;call [KERNEL32_OUTPUTDEBUGSTRINGA-geteip+ebx]<br/>
&#09;push 5000<br/>
&#09;call [KERNEL32_SLEEP-geteip+ebx]<br/>
<br/>
&#09;ret<br/>
&#09;<br/>
%include "sc-api-functions.asm"<br/>
&#09;<br/>
KERNEL32_HASHES_TABLE:<br/>
&#09;dd KERNEL32_OUTPUTDEBUGSTRINGA_HASH<br/>
&#09;dd KERNEL32_SLEEP_HASH<br/>
<br/>
KERNEL32_FUNCTIONS_TABLE:<br/>
KERNEL32_OUTPUTDEBUGSTRINGA dd 0x00000000<br/>
KERNEL32_SLEEP dd 0x00000000<br/>
<br/>
HELLO:<br/>
&#09;db "Hello from sc-ods", 0<br/>
</body></html>