<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Get Domain Users (GDU)</title>
</head><body>#################################################################<br/>
# GET DOMIAIN USERS (GDU) - Overview<br/>
#################################################################<br/>
&nbsp;Script Name: Get Domain Users (GDU)<br/>
&nbsp;Author: Scott Sutherland(nullbind)&lt;scott.sutherland@netspi.com&gt;<br/>
&nbsp;Version: 1.1<br/>
<br/>
&nbsp;Description:<br/>
&nbsp;This script is intended to automate Windows domain user <br/>
&nbsp;enumeration using multiple methods, and initiate a <br/>
&nbsp;dictionary attack against the accounts with respect to the <br/>
&nbsp;acccount lockout policy.<br/>
<br/>
&nbsp;Technical Summary:<br/>
&nbsp;1) Determine domain from IPCONFIG (option provided to override)<br/>
&nbsp;2) Identify domain controllers via DNS server queries<br/>
&nbsp;3) Enumerate users via RCP endpoints with Dumpsec<br/>
&nbsp;4) Enumerate users via RCP endpoints with Enum<br/>
&nbsp;5) Enumerate users via RCP SID Brute forcing with the Metasploit<br/>
&nbsp; &nbsp; smb_lookupsid module<br/>
&nbsp;6) Enumerate users via SNMP default strings with the Metasploit<br/>
&nbsp; &nbsp; snmp_enumusers module<br/>
&nbsp;7) Enumerate password policy with Dumpsec<br/>
&nbsp;8) Conduct dictionary attack using top 20 rockyou password list <br/>
&nbsp; &nbsp; against enumerated users with Metasploit smb_login module <br/>
&nbsp; &nbsp; with respect to the password policy<br/>
&#09;&#09;<br/>
&nbsp;Authentication Methods:<br/>
&nbsp;Users can authenticate with one of three options during attack.<br/>
&nbsp;1) Null SMB Login<br/>
&nbsp;2) Trusted connection<br/>
&nbsp;3) Username and password<br/>
<br/>
&nbsp;Notes:<br/>
&nbsp;1) If no lockout policy exists, the dictionary attack will be <br/>
&nbsp; &nbsp; aborted so it can be manually confirmed.<br/>
&nbsp;2)If the lockout policy cannot be determined the dicitonary<br/>
&nbsp; &nbsp; attack will be aborted.<br/>
<br/>
#################################################################<br/>
# GET DOMIAIN USERS (GDU) - Installation<br/>
#################################################################<br/>
&nbsp;<br/>
&nbsp;1) Download GDU.bat<br/>
&nbsp;<br/>
&nbsp;2) Download the freeware tools below<br/>
&nbsp;<br/>
&#09;&#09;Joeware Tools<br/>
&#09;&#09;http://www.joeware.net/freetools/<br/>
&#09;&#09;Download the tools below:<br/>
&#09;&#09;- NetSess.exe <br/>
&#09;&#09;- adfind.exe &#09;&#09;<br/>
<br/>
&#09;&#09;UnxUtils<br/>
&#09;&#09;Source - http://sourceforge.net/projects/unxutils/<br/>
&#09;&#09;I recommend downloading the endtire toolset, but<br/>
&#09;&#09;at a minimum you'll need the files below:<br/>
&#09;&#09;- grep.exe <br/>
&#09;&#09;- gawk.exe &nbsp;<br/>
&#09;&#09;- uniq.exe<br/>
&#09;&#09;- tail.exe<br/>
&#09;&#09;- head.exe<br/>
&#09;&#09;- sort.exe<br/>
&#09;&#09;- tr.exe<br/>
&#09;&#09;<br/>
&#09;&#09;Dumpssec<br/>
&#09;&#09;http://www.systemtools.com/somarsoft/?somarsoft.com<br/>
&#09;&#09;<br/>
&#09;&#09;Metasploit<br/>
&#09;&#09;http://www.metasploit.com<br/>
&#09;&#09;<br/>
&#09;&#09;Enum<br/>
&#09;&#09;http://www.google.com<br/>
<br/>
&nbsp;3) Add the new freeware program directories to the executable PATH.<br/>
&nbsp;<br/>
&nbsp;4) Modify the dumpsec, enum, and metasploit paths in GDU.bat.<br/>
&nbsp;<br/>
&nbsp;5) Modify/add passwords to script.<br/>
&nbsp;<br/>
&nbsp;6) Execute script.<br/>
<br/>
################################################################<br/>
# GET DOMIAIN USERS (GDU) - Usage<br/>
################################################################<br/>
<br/>
&nbsp; &nbsp;Syntax: gdu [options]<br/>
<br/>
&nbsp; &nbsp;Options:<br/>
<br/>
&nbsp; &nbsp; -n Authenticate with a null SMB login<br/>
&nbsp; &nbsp; -t Authenticate with a trusted connection (current user)<br/>
&nbsp; &nbsp; -a Authenticate with a supplied credentials<br/>
&nbsp; &nbsp; -u User name to authenticate with<br/>
&nbsp; &nbsp; -p Password to authenticate with<br/>
&nbsp; &nbsp; -g Domain group name for finding active member sessions<br/>
&nbsp; &nbsp; -c custom domain<br/>
<br/>
&nbsp; &nbsp;Examples (basic):<br/>
&nbsp;<br/>
&nbsp; &nbsp; gdu -n &#09;&#09;&#09;&#09;&#09;&#09;&#09;<br/>
&nbsp; &nbsp; gdu -t<br/>
&nbsp; &nbsp; gdu -a -u "domain\user" -p password<br/>
&nbsp; &nbsp; gdu -g "group name" -u "domain\user" -p password <br/>
<br/>
&nbsp; &nbsp;Examples (custom domain):<br/>
<br/>
&nbsp; &nbsp; gdu -n -c domain.com&#09;&#09;&#09;&#09;&#09;&#09;&#09;<br/>
&nbsp; &nbsp; gdu -t -c domain.com<br/>
&nbsp; &nbsp; gdu -a -u "domain\user" -p password -c domain.com<br/>
&nbsp; &nbsp; gdu -g "group name" -u "domain\user" -p password -c domain.com<br/>
<br/>
################################################################<br/>
# GET DOMIAIN USERS (GDU) - Todo<br/>
################################################################<br/>
&nbsp; <br/>
&nbsp;1) Add fast/comprehensive modes - fast=stop user enumeration on first success.<br/>
&nbsp;2) Add custom dictionary option.<br/>
&nbsp;3) Add check for required executables before running.<br/>
&nbsp;4) Add some more error checking.<br/>
&nbsp;5) Write the script in a real programming lanugage . - Maybe ruby... &nbsp;:)</body></html>