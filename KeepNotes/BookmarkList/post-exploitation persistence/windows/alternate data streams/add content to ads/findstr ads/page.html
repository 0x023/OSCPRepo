<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Findstr ADS</title>
</head><body>Also in my research I found that Findstr can also be used to inject a payload into another file as an ADS stream. Findstr.exe is basically a command you use to find strings within files.<br/>
More about the binary here: <a href="https://ss64.com/nt/findstr.html">https://ss64.com/nt/findstr.html</a><br/>
<br/>
The cool thing I figured out was that you can search for a string that does not exist in a file and pipe that into a new file. And the cool thing is that it does allow it to be piped into a ADS stream of a file. It looks like this:<br/>
<br/>
echo "empty file" &gt; c:\ADS\file.txt<br/>
findstr /V /L W3AllLov3DonaldTrump c:\ADS\procexp.exe &gt; c:\ADS\file.txt:procexp.exe<br/>
wmic process call create '"c:\ADS\file.txt:procexp.exe"'<br/>
The /V in the findstr command makes sure that everything that does not match the string I am searching for is showed. </body></html>