<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Monitor The Backdoor</title>
</head><body>We can monitor BITS requests in our Apache access.log as follows, or we can do better...<br/>
<br/>
To generate a log that leverages our custom file names and request headers, we add some Apache CustomLog and SetEnvIf directives to /etc/apache2/sites-enabled/000-default<br/>
<img src="image.png" /><br/>
<br/>
After restarting Apache, we now have a BITS only log with the exact information we need:<br/>
<img src="image 2.png" /><br/>
<br/>
Unfortunately, we aren't quite done yet. If our BITS job sends a HEAD requests for a file that does not exist we completely lose access.<br/>
From MSDN:<ul><li style="list-style-type: none">ERROR â€” A nonrecoverable error occurred; the transfer will not be retried.</li>
</ul>
</body></html>