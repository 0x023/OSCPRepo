<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Mitigation</title>
</head><body>This one is easier to find. &nbsp;The BITSADMIN tool also lets you view scheduled downloads. &nbsp;You can get a list of scheduled task with the command “BITSADMIN /LIST”<br/>
<img src="image.png" /><br/>
<br/>
Here you can see there is a job called “getsome” that is currently scheduled on this machine. &nbsp; "BITSADMIN /LISTFILES &lt;jobname&gt;" takes a scheduled job as a parameter and returns a list of URLs the job is scheduled to download. &nbsp;For example, here we see that job “getsome” is scheduled to download from the url HTTP://attackerssite.com/malware.exe &nbsp;and it will save the file as c: empmalware.exe.<br/>
<img src="image 2.png" /><br/>
<br/>
But how does the malware execute after it is downloaded? &nbsp; &nbsp;BITS will allow you to schedule a command to execute after a successful download to notify you that the job is finished. &nbsp; The intention is that you can execute a program and have it send you an email or fire an alert in a network monitoring system. &nbsp;Let’s check the notification program on this program with BITSADMIN /GETNOTIFYCMDLINE &lt;jobname&gt;. &nbsp;To use it provide the job name as an argument like this:<br/>
<img src="image 3.png" /><br/>
<br/>
Here you can see that after the malware is successfully downloaded to c:&#09;empmalware.exe the BITS service will launch c:&#09;empmalware.exe “to notify the administrator”.</body></html>