<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>Assumptions<br/>
&nbsp; &nbsp; You have already elevated or have Local Admin context on the box<br/>
&nbsp; &nbsp; Have the ability to upload a file in your agent (CobaltStike) / Have a Deployable .BAT/PS script<br/>
&nbsp; &nbsp; Willing to drop something to disk for persistence<br/>
<br/>
The current process I use to deploy a Cobalt Strike Fully Staged Beacon:<br/>
<br/>
&nbsp; &nbsp; Enumerate current GPO scripts<br/>
&nbsp; &nbsp; Remove the psscripts.ini<br/>
&nbsp; &nbsp; Upload a new psscripts.ini<br/>
&nbsp; &nbsp; Upload the Beacon.ps1 scripts<br/>
&nbsp; &nbsp; conduct a Gpupdate<br/>
&nbsp; &nbsp; On restart you should get a beacon!<br/>
<br/>
The location of interest (while this seems trivial, do to the permissions on this directory you will have to force all commands):<br/>
<br/>
As you will noticed the structure goes (the 0Cmd.. is incremental):<br/>
[ScriptsConfig]<br/>
StartExecutePSFirst=true<br/>
[Startup]<br/>
0CmdLine=beacon2.ps1<br/>
0Parameters=<br/>
<br/>
</body></html>