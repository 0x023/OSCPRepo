<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Nested Commands</title>
</head><body><b>Prior to Autoruns 13.80; Hide Behind Existing Autoruns</b><br/>
Find an autorun like this:<br/>
&nbsp;&#09;c:\windows\system32\vboxtray.exe<br/>
Edit command like this:<br/>
&nbsp;&#09;cmd.exe /c start c:\windows\system32\vboxtray.exe &amp; evil.exe<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Autoruns parsed the command and detected the /c, reported the nested command rather than cmd.exe<br/>
Makes hiding malware harder<br/>
&nbsp;&#09;Nesting malicious exe under cmd.exe won't display as Microsoft applications and won't hide when hiding Microsoft entries<br/>
<br/>
It was still possible to hide if first nested exec is signed by Microsoft<br/>
&nbsp;&#09;cmd.exe /c start consent.exe &amp; evil.exe &#09;&#09;where consent.exe is Microsoft exec distributed with Windows<br/>
<br/>
<b>Autoruns 13.80</b>&nbsp;<b>stopped trying to parse most nested commands</b><br/>
&nbsp;&#09;cmd.exe /c evil.exe &nbsp;&#09;&#09;displays as cmd.exe now<br/>
&nbsp;&#09;No longer hides cmd.exe (and others) when hiding Microsoft entries<br/>
&nbsp;&#09;Persisted cmd.exe is now more obvious, but requires understanding what is legit and what is malicious</body></html>