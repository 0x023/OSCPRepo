<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Other Avenues</title>
</head><body>https://jumpespjump.blogspot.com/2015/03/thousand-ways-to-backdoor-windows.html<br/>
<ul><li>Create a new domain admin user. Easy to do, easy to detect, easy to remediate</li>
<li>Dump password hashes. The attacker can either crack those, or just pass-the-hash. Since KB2871997, pass-the-hash might be trickier (<a href="https://technet.microsoft.com/library/security/2871997">https://technet.microsoft.com/library/security/2871997</a>), but not impossible. Easy to do, hard to detect, hard to remediate - just think about service user passwords. And during remediation, consider all passwords compromised, even strong ones.</li>
<li>Logon scripts - modify the logon scripts and add something malicious in it. Almost anything detailed in this post can be added :D</li>
<li>Use an already available account, and add domain admin privileges to that. Reset it's password. Mess with current group memberships - e.g. <a href="http://www.exploit-db.com/papers/17167/">http://www.exploit-db.com/papers/17167/</a></li>
<li>Backdoor any workstation where domain admins log in. While remediating workstations, don't forget to clean the roaming profile. The type of the backdoor can use different forms: malware, local admin, password (hidden admin with 500 RID), sticky keys, etc.</li>
<li>Backdoor any domain controller server. For advanced attacks, see <a href="https://github.com/gentilkiwi/mimikatz/releases/tag/2.0.0-alpha-20150117">Skeleton keys</a>&nbsp;(<a href="nbk:///6a3fb416-74e6-4ced-a0c0-ee6879fbebee">Skeleton Key in BookmarkList</a>)</li>
<li>Backdoor files on network shares which are commonly used by domain admins by adding malware to commonly used executables - <a href="https://github.com/secretsquirrel/the-backdoor-factory">Backdoor factory</a></li>
<li>Change ownership/permissions on AD partitions - if you have particular details on how to do this specifically, please comment</li>
<li>Create a new domain user. Hide admin privileges with <a href="nbk:///2d44bdcb-1963-4bc1-96fc-b608bdc04445">SID history</a>. Easy to do, hard to detect, easy to remediate - check <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz </a>experimental for addsid</li>
<li><a href="http://rycon.hu/papers/goldenticket.html">Golden tickets</a> - easy to do, hard to detect, medium remediation</li>
<li><a href="http://www.beneaththewaves.net/Projects/Mimikatz_20_-_Silver_Ticket_Walkthrough.html">Silver tickets</a> - easy to do, hard to detect, medium/hard remediation</li>
</ul>
<ul>Backdoor workstations/servers via group policy</ul>
<ul><li>HKEY_LOCAL_MACHINE\ Software\ Microsoft\ Windows\ CurrentVersion\ RunOnce,</li>
<li>scheduled tasks (run task 2 years later),</li>
<li><a href="http://www.labofapenetrationtester.com/2012/05/fun-with-sticky-keys-utilman-and.html">sticky-keys with debug</a></li>
<li><a href="https://www.youtube.com/watch?v=Mz9Bg9KAKBs">Backdoor patch management tool</a>, see <a href="https://www.trustedsec.com/files/Owning_One_Rule_All_v2.pdf">slides here</a></li>
</ul>
&nbsp;<br/>
<br/>
More<ul><li>Backdoor recent backups - and when backdoor is needed, destroy the files, so the files will be restored from the backdoored backup</li>
<li>Backdoor the Exchange server - get a copy of emails</li>
<li>Backdoor workstation/server golden image</li>
<li>Change permission of logon scripts to allow modification later</li>
<li>Place malicious symlinks to file shares, collect hashes via SMB auth tries on specified IP address, grab password hashes later</li>
<li>Backdoor remote admin management e.g. HP iLO - e.g. create new user, or steal current password</li>
<li>Backdoor files e.g. on shares to use in SMB relay</li>
<li>Backdoor source code of in-house-developed software</li>
<li>Use any type of sniffed or reused passwords in new attacks, e.g. network admin, firewall admin, VPN admin, AV admin, etc.</li>
<li>Change the content of the proxy pac file (change browser configuration if necessary), include special exception(s) for a chosen domain(s)  to use proxy on malicious IP. Redirect the traffic, enforce authentication, grab password hashes, ???, profit.</li>
<li>Create high privileged users in applications running with high privileges, e.g. MSSQL, Tomcat, and own the machine, impersonate users, grab their credentials, etc. The typical pentest path made easy.</li>
<li>Remove patches from servers, change patch policy not to install those patches.</li>
<li>Steal Windows root/intermediate CA keys</li>
<span style="font-size: 10pt"><li>Weaken AD security by changing group policy (e.g. re-enabling LM-hashes)</li>
</span></ul>
<span style="font-size: 10pt"><div style="text-align: justify">Update [2015-09-27]: I found this </div><a href="https://www.youtube.com/watch?v=w6761-NWmj4">great presentation</a><div style="text-align: justify"> from Jakob Heidelberg. It mentions (at least) the following techniques, it is worth to check these:</div></span><ul><li style="list-style-type: none"><ul><li>Microsoft Local Administrator Password Solution</li>
<li>Enroll virtual smart card certificates for domain admins</li>
</ul>
</li>
</ul>
&nbsp;</body></html>