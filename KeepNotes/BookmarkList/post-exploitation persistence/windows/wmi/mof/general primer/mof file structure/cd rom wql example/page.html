<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CD Rom WQL Example</title>
</head><body>Using WQL almost any hardware or operating system event can be set as and event trigger. I highly recommend that you take some time to review the Win32 Provider Classes to get an understanding of the scope of these events. As always, the best way to learn is to try to formulate some queries on your local host. In powershell the Get-WmiObject cmdlet can be used, in conjunction with the provided link, to get instances of WMI classes.<br/>
<br/>
# Cursory information can be retrieved by only specifying the class name.<br/>
PS C:\Windows\system32&gt; Get-WmiObject -class Win32_CDROMDrive<br/>
<br/>
# Using the ConfigManagerErrorCode property we can check if the drive is functioning normally.<br/>
PS C:\Windows\system32&gt; Get-WmiObject -query "select ConfigManagerErrorCode from Win32_CDROMDrive"<br/>
<br/>
# Using the Capabilities property we can check capabilities of the device.<br/>
PS C:\Windows\system32&gt; Get-WmiObject -query "select Capabilities from Win32_CDROMDrive"<br/>
<br/>
# Using the MediaLoaded property we can check if the drive currently has a CD-Rom.<br/>
PS C:\Windows\system32&gt; Get-WmiObject -query "select MediaLoaded from Win32_CDROMDrive"<br/>
<br/>
As an example could create a WQL event trigger which would wait for a CD-Rom to be inserted into a drive on the system. When the WQL query determins a CD-Rom drive has been inserted it will then trigger an action. The sample WQL query can been seen below.<br/>
<br/>
# Notice that we are checking for an instance modification where the value for "MediaLoaded" changes from<br/>
&nbsp; "False" to "True".<br/>
Query = "SELECT * FROM __InstanceModificationEvent Within 5"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "Where TargetInstance Isa \"Win32_CDROMDrive\" "<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "And Targetinstance.MediaLoaded = \"True\" ";</body></html>