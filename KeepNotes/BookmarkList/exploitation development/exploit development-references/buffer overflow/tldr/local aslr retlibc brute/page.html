<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Local ASLR Bruteforce</title>
</head><body>Buffer Overflow<br/>
Determine length of overflow trigger w/ binary search "A"x1000<br/>
Determine exact EIP with pattern_create.rb -l 1000, &amp; pattern_offset.rb -q &lt;pattern&gt;<br/>
Determine badchars to make sure all of your payload is getting through<br/>
Determine range of addresses for LIBC<br/>
Determine offsets for LIBC: system and exit<br/>
Determine offset for /bin/sh<br/>
Develop exploit<br/>
&nbsp;&#09;base_libc<ul><li style="list-style-type: none">system_offset</li>
<li style="list-style-type: none">exit_offset</li>
<li style="list-style-type: none">binsh_offset</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">system_addr = base_libc + system_off</li>
<li style="list-style-type: none">exit_addr = base_libc + exit_off</li>
<li style="list-style-type: none">binsh_addr = base_libc + binsh_off</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">buf = A*overflow&#09;&#09;&#09;#will run program x number of times to bruteforce landing at this address</li>
<li style="list-style-type: none">buf+=system_addr</li>
<li style="list-style-type: none">buf+=exit_addr</li>
<li style="list-style-type: none">buf+=binsh_addr</li>
</ul>
<br/>
&nbsp;&#09;while &lt; num_times_need_to_run:<br/>
&nbsp;&#09;&#09;call([vuln_program, buf])<br/>
<br/>
<br/>
</body></html>