<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SeLoadDriverPrivilege Exploitation</title>
</head><body>0x05 – Exploitation &nbsp;<br/>
Once we have been able to load a driver from an unprivileged user account, the next step is to identify a signed driver that has a vulnerability that allows to elevate privileges.<br/>
<br/>
For this example, we have selected the driver Capcom.sys (SHA1: c1d5cf8c43e7679b782630e93f5e6420ca1749a7) which has a ‘functionality’ that allows to execute code in kernel space from a function defined in user space.<br/>
<br/>
This driver has different public exploits:<br/>
<ul><li><b>ExploitCapcom from Tandasat</b> – <a href="https://github.com/tandasat/ExploitCapcom">https://github.com/tandasat/ExploitCapcom</a>&nbsp;– This exploit allows you to obtain a Shell as SYSTEM</li>
<li><b>PuppetStrings by zerosum0x0</b> – <a href="https://github.com/zerosum0x0/puppetstrings">https://github.com/zerosum0x0/puppetstrings</a>&nbsp;– Allows hiding running processes</li>
</ul>
&nbsp;<br/>
Following the procedure described above, we need to spawn an elevated terminal in order to obtain an unrestricted token. After this, we can execute the PoC tool (EOPLOADDRIVER) to enable the SeLoadDriverPrivilege and load the selected driver as shown below:<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Once the driver is loaded it is possible to run any desired exploit. The following image shows the use of Tandasat’s exploit “ExploitCapcom” to obtain a terminal as SYSTEM.<br/>
<br/>
<img src="image 2.png" /><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>