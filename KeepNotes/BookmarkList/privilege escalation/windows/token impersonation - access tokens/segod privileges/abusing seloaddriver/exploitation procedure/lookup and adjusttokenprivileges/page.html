<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Code</title>
</head><body>TOKEN_PRIVILEGES tp;<br/>
LUID luid;<br/>
if (!LookupPrivilegeValue(<br/>
&nbsp; NULL, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// lookup privilege on local system<br/>
&nbsp; lpszPrivilege, &nbsp; // privilege to lookup <br/>
&nbsp; &amp;luid)) &nbsp; &nbsp; &nbsp; &nbsp;// receives LUID of privilege<br/>
{<br/>
&nbsp; printf("LookupPrivilegeValue error: %un", GetLastError());<br/>
&nbsp; return FALSE;<br/>
}<br/>
tp.PrivilegeCount = 1;<br/>
tp.Privileges[0].Luid = luid;<br/>
if (bEnablePrivilege)<br/>
&nbsp; tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;<br/>
else<br/>
&nbsp; tp.Privileges[0].Attributes = 0;<br/>
// Enable the privilege or disable all privileges.<br/>
if (!AdjustTokenPrivileges(<br/>
&nbsp; hToken,<br/>
&nbsp; FALSE,<br/>
&nbsp; &amp;tp,<br/>
&nbsp; sizeof(TOKEN_PRIVILEGES),<br/>
&nbsp; (PTOKEN_PRIVILEGES)NULL,<br/>
&nbsp; (PDWORD)NULL))<br/>
{<br/>
&nbsp; printf("AdjustTokenPrivileges error: %un", GetLastError());<br/>
&nbsp; return FALSE;<br/>
}</body></html>