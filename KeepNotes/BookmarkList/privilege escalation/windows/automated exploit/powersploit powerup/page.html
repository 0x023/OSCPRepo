<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>PowerSploit PowerUp</title>
</head><body><a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc">https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc</a><br/>
<br/>
To install this module, drop the entire Privesc folder into one of your module directories. The default PowerShell module paths are listed in the $Env:PSModulePath environment variable.<br/>
<br/>
The default per-user module path is: "$Env:HomeDrive$Env:HOMEPATH\Documents\WindowsPowerShell\Modules" The default computer-level module path is: "$Env:windir\System32\WindowsPowerShell\v1.0\Modules"<br/>
<br/>
To use the module, type Import-Module Privesc<br/>
<br/>
To see the commands imported, type Get-Command -Module Privesc<br/>
<br/>
For help on each individual command, Get-Help is your friend.<br/>
<br/>
Note: The tools contained within this module were all designed such that they can be run individually. Including them in a module simply lends itself to increased portability.<br/>
<br/>
<b>PowerUp</b><br/>
<br/>
PowerUp aims to be a clearinghouse of common Windows privilege escalation vectors that rely on misconfigurations.<br/>
<br/>
Running Invoke-AllChecks will output any identifiable vulnerabilities along with specifications for any abuse functions. The -HTMLReport flag will also generate a COMPUTER.username.html version of the report.<br/>
<br/>
Author: @harmj0y License: BSD 3-Clause Required Dependencies: None Optional Dependencies: None<br/>
<br/>
<b>Service Enumeration:</b><br/>
<br/>
Get-ServiceUnquoted &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; returns services with unquoted paths that also have a space in the name<br/>
Get-ModifiableServiceFile &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; returns services where the current user can write to the service binary path or its config<br/>
Get-ModifiableService &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; returns services the current user can modify<br/>
Get-ServiceDetail &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; returns detailed information about a specified service<br/>
<br/>
Service Abuse:<br/>
<br/>
Invoke-ServiceAbuse &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; modifies a vulnerable service to create a local admin or execute a custom command<br/>
Write-ServiceBinary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; writes out a patched C# service binary that adds a local admin or executes a custom command<br/>
Install-ServiceBinary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; replaces a service binary with one that adds a local admin or executes a custom command<br/>
Restore-ServiceBinary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; restores a replaced service binary with the original executable<br/>
<br/>
DLL Hijacking:<br/>
<br/>
Find-ProcessDLLHijack &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; finds potential DLL hijacking opportunities for currently running processes<br/>
Find-PathDLLHijack &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; finds service %PATH% DLL hijacking opportunities<br/>
Write-HijackDll &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;&#09;- &nbsp; writes out a hijackable DLL<br/>
<br/>
Registry Checks:<br/>
<br/>
Get-RegistryAlwaysInstallElevated &nbsp; - &nbsp;checks if the AlwaysInstallElevated registry key is set<br/>
Get-RegistryAutoLogon &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; checks for Autologon credentials in the registry<br/>
Get-ModifiableRegistryAutoRun &#09;- &nbsp; checks for any modifiable binaries/scripts (or their configs) in HKLM autoruns<br/>
<br/>
Miscellaneous Checks:<br/>
<br/>
Get-ModifiableScheduledTaskFile&#09;- &nbsp; find schtasks with modifiable target files<br/>
Get-UnattendedInstallFile &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; finds remaining unattended installation files<br/>
Get-Webconfig &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;&#09;- &nbsp; checks for any encrypted web.config strings<br/>
Get-ApplicationHost &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; checks for encrypted application pool and virtual directory passwords<br/>
Get-SiteListPassword &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; retrieves the plaintext passwords for any found McAfee's SiteList.xml files<br/>
Get-CachedGPPPassword &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - &nbsp; checks for passwords in cached Group Policy Preferences files<br/>
<br/>
Other Helpers/Meta-Functions:<br/>
<br/>
Get-ModifiablePath &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; tokenizes an input string and returns the files in it the current user can modify<br/>
Get-CurrentUserTokenGroupSid &nbsp;&#09;- &nbsp; returns all SIDs that the current user is a part of, whether they are disabled or not<br/>
Add-ServiceDacl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#09;- &nbsp; adds a Dacl field to a service object returned by Get-Service<br/>
Set-ServiceBinPath &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; sets the binary path for a service to a specified value through Win32 API methods<br/>
Test-ServiceDaclPermission &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; tests one or more passed services or service names against a given permission set<br/>
Write-UserAddMSI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; write out a MSI installer that prompts for a user to be added<br/>
Invoke-AllChecks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#09;- &nbsp; runs all current escalation checks and returns a report<br/>
</body></html>