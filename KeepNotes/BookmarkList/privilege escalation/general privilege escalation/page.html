<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Privilege Escalation</title>
</head><body>Linux: For Enumeration scripts, see Tools &gt; Linux Local Enumeration &gt; Auditing and Enumeration<br/>
Windows: For Enumeration scripts, see Tools &gt; Windows Local Enumeration &gt; Auditing and Enumeration<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Linux<br/>
[Its Too Funky In Here04 Linux priv esc for fun profit and mischief Jake Willi](<a href="https://www.youtube.com/watch?v=dk2wsyFiosg">https://www.youtube.com/watch?v=dk2wsyFiosg</a>)<br/>
<br/>
Windows<br/>
WINRM<br/>
<a href="https://pentestn00b.wordpress.com/2016/08/22/powershell-psremoting-pwnage/">Exploiting Trusted Hosts in WinRM</a><br/>
<a href="https://pentestn00b.wordpress.com/2016/08/22/powershell-psremoting-pwnage/">PowerShell PSRemoting Pwnage</a><br/>
<a href="https://lockboxx.blogspot.com/2015/07/powershell-remoting-for-penetration.html">PowerShell Remoting for Penetration Testers</a><br/>
&nbsp;<br/>
<a href="http://harmj0y.net/">http://harmj0y.net</a>&nbsp;&#09;&#09;&#09;&#09;&#09;&#09;Windows (harmj0y = Empire)<br/>
<a href="https://www.youtube.com/watch?v=kMG8IsCohHA">https://www.youtube.com/watch?v=kMG8IsCohHA</a>&nbsp;Encyclopaedia Of Windows Privilege Escalation (Brett Moore)<br/>
<a href="http://www.youtube.com/watch?v=_8xJaaQlpBo">http://www.youtube.com/watch?v=_8xJaaQlpBo</a>&nbsp;DerbyCon 3 0 2105 Windows Attacks AT Is The New Black<br/>
<a href="https://www.youtube.com/watch?v=PC_iMqiuIRQ">https://www.youtube.com/watch?v=PC_iMqiuIRQ</a>&nbsp;Windows<br/>
<br/>
"In place" Movement:<br/>
<br/>
1) Token Stealing<br/>
&nbsp; &nbsp;Once you have admin access on a computer, you can use the tokens of the<br/>
&nbsp; &nbsp;other users to access resources in the domain. Two tools for doing this are<br/>
&nbsp; &nbsp;incognito [1] and the mimikatz token::* commands [2].<br/>
<br/>
2) MS14-068<br/>
&nbsp; &nbsp;You can take advantage of a validation bug in Kerberos to generate Domain<br/>
&nbsp; &nbsp;Admin tickets [3][4][5].<br/>
<br/>
3) Pass the Hash<br/>
&nbsp; &nbsp;If you have a user's hash, but they're not logged in, you can use<br/>
&nbsp; &nbsp;sekurlsa::pth [2] to get a ticket for the user.<br/>
<br/>
4) Process Injection<br/>
&nbsp; &nbsp;Any RAT can inject itself into other processes. For example, the migrate<br/>
&nbsp; &nbsp;command in meterpreter and pupy [6], or the psinject [7] command in<br/>
&nbsp; &nbsp;powershell empire. You can inject into the process that has the token you<br/>
&nbsp; &nbsp;want.<br/>
<br/>
5) runas<br/>
&nbsp; &nbsp;This is sometimes very useful since it doesn't require admin privileges.<br/>
&nbsp; &nbsp;The command is part of windows, but if you don't have a GUI you can use<br/>
&nbsp; &nbsp;powershell [8].<br/>
<br/>
[1] https://www.indetectables.net/viewtopic.php?p=211165<br/>
[2] https://adsecurity.org/?page_id=1821<br/>
[3] https://github.com/bidord/pykek<br/>
[4] https://adsecurity.org/?p=676<br/>
[5] http://www.hackplayers.com/2014/12/CVE-2014-6324-como-validarse-con-cualquier-usuario-como-admin.html<br/>
[6] https://github.com/n1nj4sec/pupy<br/>
[7] http://www.powershellempire.com/?page_id=273<br/>
[8] https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Invoke-Runas.ps1<br/>
<br/>
Complete <br/>
Linux<br/>
<a href="http://www.slideshare.net/nullthreat/fund-linux-priv-esc-wprotections">http://www.slideshare.net/nullthreat/fund-linux-priv-esc-wprotections</a><br/>
<a href="http://www.irongeek.com/i.php?page=videos/bsidesaugusta2016/its-too-funky-in-here04-linux-privilege-escalation-for-fun-profit-and-all-around-mischief-jake-williams">http://www.irongeek.com/i.php?page=videos/bsidesaugusta2016/its-too-funky-in-here04-linux-privilege-escalation-for-fun-profit-and-all-around-mischief-jake-williams</a><br/>
[Reach the root](<a href="https://hackmag.com/security/reach-the-root/">https://hackmag.com/security/reach-the-root/</a>) | discusses a process for linux privilege exploitation<br/>
[Basic linux privilege escalation](<a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a>) | basic linux exploitation, also covers Windows<br/>
http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html<br/>
[Privilege escalation linux with live example](<a href="http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/">http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/</a>) | covers a couple common PE methods in linux<br/>
[Local Linux Enumeration &amp; Privilege Escalation Cheatsheet](<a href="https://www.rebootuser.com/?p=1623">https://www.rebootuser.com/?p=1623</a>) | good resources that could be compiled into a script<br/>
<a href="https://www.rebootuser.com/?page_id=1721">https://www.rebootuser.com/?page_id=1721</a><br/>
<a href="http://www.rebootuser.com/?p=1758">http://www.rebootuser.com/?p=1758</a><br/>
[4 Ways get linux privilege escalation](<a href="http://www.hackingarticles.in/4-ways-get-linux-privilege-escalation/">http://www.hackingarticles.in/4-ways-get-linux-privilege-escalation/</a>) | shows different examples of PE scripts<br/>
linux-exploit-suggester, older: <a href="https://github.com/PenturaLabs/Linux_Exploit_Suggester">https://github.com/PenturaLabs/Linux_Exploit_Suggester</a>&nbsp; <br/>
linux-exploit-suggester, updated!: <a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a>&nbsp; <br/>
mimipenguin, mimicatz ish for linux: <a href="https://github.com/huntergregal/mimipenguin">https://github.com/huntergregal/mimipenguin</a><br/>
<a href="http://netsec.ws/?p=309">http://netsec.ws/?p=309</a>&nbsp;&lt;- just a link to scripts<br/>
<a href="https://github.com/sagishahar/lpeworkshop/blob/master/Lab%20Exercises%20Walkthrough%20-%20Linux.pdf ">https://github.com/sagishahar/lpeworkshop/blob/master/Lab%20Exercises%20Walkthrough%20-%20Linux.pdf </a><br/>
<a href="https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html">https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html</a>&nbsp;<br/>
http://rachid.koucha.free.fr/tech_corner/shared_libs_tests.html<br/>
<br/>
Windows<br/>
<a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/My-5-Top-Ways-to-Escalate-Privileges/">https://www.trustwave.com/Resources/SpiderLabs-Blog/My-5-Top-Ways-to-Escalate-Privileges/</a><br/>
[Windows Privilege Escalation](<a href="http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation">http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation</a>) | collection of wiki pages covering Windows Privilege escalation<br/>
<a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a>&nbsp;| In tools section<br/>
<a href="https://github.com/pentestmonkey/windows-privesc-check">https://github.com/pentestmonkey/windows-privesc-check</a>&nbsp; | In tools section<br/>
<a href="https://github.com/foxglovesec/RottenPotato">https://github.com/foxglovesec/RottenPotato</a>&nbsp; | In tools section<br/>
<a href="https://blog.gdssecurity.com/labs/2014/7/11/introducing-windows-exploit-suggester.html">https://blog.gdssecurity.com/labs/2014/7/11/introducing-windows-exploit-suggester.html</a>&nbsp; | In tools section<br/>
[Windows Privilege Escalation Fundamentals](<a href="http://www.fuzzysecurity.com/tutorials/16.html">http://www.fuzzysecurity.com/tutorials/16.html</a>) | collection of great info/tutorials, option to contribute to the creator through patreon, creator is an OSCP (fantastic)<br/>
<a href="http://www.greyhathacker.net/?p=738">http://www.greyhathacker.net/?p=738</a>&nbsp;| Elevating privileges by exploiting weak folder permissions (Parvez Anwar) (fantastic)<br/>
<a href="http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/">http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a>&nbsp; (fantastic)<br/>
<a href="https://blog.netspi.com/windows-privilege-escalation-part-1-local-administrator-privileges/">https://blog.netspi.com/windows-priv...or-privileges/</a><br/>
<a href="https://blog.netspi.com/windows-privilege-escalation-part-2-domain-admin-privileges/">https://blog.netspi.com/windows-priv...in-privileges/</a><br/>
<a href="http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html">http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html</a>&nbsp;- Windows <br/>
<a href="http://www.toshellandback.com/2015/11/24/ms-priv-esc/">www.toshellandback.com/2015/11/24/ms-priv-esc/</a>&nbsp; - Windows (fantastic)<br/>
<a href="http://www.blackhillsinfosec.com/?p=5824">http://www.blackhillsinfosec.com/?p=5824</a>&nbsp; | HostRecon Script information<br/>
<a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/">https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</a>&nbsp;(fantastic)<br/>
<a href="https://www.commonexploits.com/unquoted-service-paths/ ">https://www.commonexploits.com/unquoted-service-paths/ </a>&nbsp;<br/>
<a href="https://room362.com/post/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/">https://room362.com/post/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/</a>&nbsp;<br/>
<a href="https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/">https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/</a>&nbsp;<br/>
<a href="https://adsecurity.org/?p=2288">https://adsecurity.org/?p=2288</a>&nbsp;<br/>
<a href="http://blogs.technet.com/b/markrussinovich/archive/2006/05/01/the-power-in-power-users.aspx">http://blogs.technet.com/b/markrussinovich/archive/2006/05/01/the-power-in-power-users.aspx</a>&nbsp;(Power Users group)<br/>
<a href="https://hi.cybereason.com/hubfs/Siofra-Research-Tool-Cybereason.pdf?t=1515089088070">https://hi.cybereason.com/hubfs/Siofra-Research-Tool-Cybereason.pdf?t=1515089088070</a>&nbsp;Siofra tool In tools section<br/>
[Windows privilege escalation checker]<a href="https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md">(https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md</a>) | a list of topics that link to pentestlab.blog, all related to windows privilege escalation In tools section<br/>
<a href="https://pentestlab.blog/2017/03/27/dll-hijacking/">https://pentestlab.blog/2017/03/27/dll-hijacking/</a>&nbsp;<br/>
<a href="http://www.tarasco.org/">http://www.tarasco.org/</a>&nbsp; <br/>
<a href="https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf">https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf</a>&nbsp;(fantastic) <br/>
<a href="http://windowsitpro.com/windows/netexe-reference">Net.exe reference</a><br/>
<a href="https://technet.microsoft.com/en-us/library/cc732952.aspx">Dsquery - technet</a><br/>
<a href="https://gallery.technet.microsoft.com/scriptcenter/Get-Active-Window-on-User-352fa957">Get Active Window on User Desktop - technet</a>&nbsp;This script will tell you the application that user is currently using. This also called active window. This script replies on unmanaged dll, user32.dll, to get this information. It has a function called GetForegroundWindow() which returns the Windowhandle of the active process.<br/>
<a href="https://www.vexasoft.com/pages/get-window">Get-Window</a>&nbsp;Gets the application windows that are open on the local desktop.<br/>
<a href="https://www.reddit.com/r/PowerShell/comments/2onpdm/get_active_window_titles_of_remote_computer/">Get Active Window titles of remote computer? - reddit</a><br/>
<a href="https://stackoverflow.com/questions/191206/how-to-get-list-of-running-applications-using-powershell-or-vbscript">How to get list of running applications using PowerShell or VBScript</a><br/>
<a href="https://www.darkoperator.com/blog/2013/1/31/introduction-to-wmi-basics-with-powershell-part-1-what-it-is.html">Introduction to WMI Basics with PowerShell Part 1 (What it is and exploring it with a GUI)</a>&nbsp;(In UsefulCommands primer)<br/>
<a href="http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html">Playing with MOF files on Windows, for fun &amp; profit</a>&nbsp;<br/>
<br/>
<br/>
</body></html>